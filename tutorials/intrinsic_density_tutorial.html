<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial on the usage of intrinsic_density_micelle tool &mdash; PySoftK 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=292eb321"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial on the usage of micelle_whole tool" href="micelle_whole_tutorial.html" />
    <link rel="prev" title="Tutorial on the usage of ecc_micelle" href="ecc_tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PySoftK
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="prepare_molecules.html">Preparing monomers for PySoftK</a></li>
<li class="toctree-l2"><a class="reference internal" href="monomer_polymers.html">From single molecules to polymers using PySoftK</a></li>
<li class="toctree-l2"><a class="reference internal" href="super_monomer.html">Creating a Polymer</a></li>
<li class="toctree-l2"><a class="reference internal" href="polymer_chains.html">Creating chains of Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="polymer_diblock.html">Creating diblock Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="polymer_random.html">Creating random Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="polymer_cyclic.html">Creating cyclic Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="polymer_branched.html">Creating branched Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="polymer_pattern.html">Creating patterned Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="bigamino.html">Modelling soft-matter long chain polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="combined_modules.html">Creating new polymers from different modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_folders.html">Automatic Folder Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculator.html">Computing using <strong>ab-initio</strong> calculators</a></li>
<li class="toctree-l2"><a class="reference internal" href="torsional.html">Automatic torsional angle detection for planar polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="contacts_tutorial.html">Tutorial on the usage of contacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecc_tutorial.html">Tutorial on the usage of ecc_micelle</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tutorial on the usage of intrinsic_density_micelle tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spherical-density-tool">spherical_density tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#intrinsic-density-water-tool">intrinsic_density_water tool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="micelle_whole_tutorial.html">Tutorial on the usage of micelle_whole tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="rgyr_tutorial.html">Tutorial on the usage of rgyr_micelle</a></li>
<li class="toctree-l2"><a class="reference internal" href="rgyr_mdanalysis_vs_pysoftk.html">Case example of MDAnalysis vs Pysoftk’s rgyr_micelle</a></li>
<li class="toctree-l2"><a class="reference internal" href="RSA_tutorial.html">Tutorial on the usage of RSA tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="RSA_protein_tutorial.html">Tutorial on the usage of RSA tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="SCP_tutorial.html">Tutorial on the usage of SCP tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="solvation_tutorial.html">Tutorial on the usage of hydration</a></li>
<li class="toctree-l2"><a class="reference internal" href="spherical_density_tutorial.html">Tutorial on the usage of spherical_density tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">pysoftk</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PySoftK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Tutorial on the usage of intrinsic_density_micelle tool</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/intrinsic_density_tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial-on-the-usage-of-intrinsic-density-micelle-tool">
<h1>Tutorial on the usage of intrinsic_density_micelle tool<a class="headerlink" href="#tutorial-on-the-usage-of-intrinsic-density-micelle-tool" title="Link to this heading"></a></h1>
<p>Here, two examples on how to use the intrinsic_density_micelle tool for
the calculation of the distribution of components of a micelle. First we
will show how to use intrinsic_density to calculate the density of the
hydrophobic block of the polymer. Then we will show how to use
intrinsic_density_water to calculate the spherical density of the water
in the simulation</p>
<section id="spherical-density-tool">
<h2>spherical_density tool<a class="headerlink" href="#spherical-density-tool" title="Link to this heading"></a></h2>
<p>Before starting any analysis, load the neccesary modules for this class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from  utils_mda import MDA_input
#from pysoftk.pol_analysis.tools.utils_mda import MDA_input
from utils_tools import *
#from pysoftk.pol_analysis.tools.utils_tools import *
from clustering import SCP
#from pysoftk.pol_analysis.clustering import SCP
from make_micelle_whole import micelle_whole
#from pysoftk.pol_analysis.make_micelle_whole import micelle_whole
from intrinsic_density_micelle import intrinsic_density
#from pysoftk.pol_analysis.intrinsic_density_micelle import intrinsic_density

import numpy as np
import pandas as pd
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Select your simulation files, it is recommended to use a tpr file for
the topology and xtc file for the trajectory.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>topology=&#39;data/intrinsic_density_movie.tpr&#39;
trajectory=&#39;data/intrinsic_density_movie.xtc&#39;
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Run the clustering</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>results_name=&#39;data/pictures_tutorial/cyclic_intrinsic_scp_result&#39;

cluster_cutoff = 12

start=0
stop=10001
step=1

atom_names=[&#39;C02T&#39;]

c = SCP(topology, trajectory).spatial_clustering_run(start, stop, step, atom_names, cluster_cutoff, results_name)


#load the results from SCP
resids_total=&#39;data/pictures_tutorial/cyclic_intrinsic_scp_result.parquet&#39;
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00&lt;00:00, 22.20it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">file</span> <span class="n">data</span><span class="o">/</span><span class="n">pictures_tutorial</span><span class="o">/</span><span class="n">cyclic_intrinsic_scp_result</span><span class="o">.</span><span class="n">parquet</span> <span class="n">has</span> <span class="n">been</span> <span class="n">successfully</span> <span class="n">created</span><span class="o">.</span>
<span class="n">Function</span> <span class="n">spatial_clustering_run</span> <span class="n">Took</span> <span class="mf">2.2583</span> <span class="n">seconds</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Obtain the largest micelle from the clustering pandas dataframe</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>largest_micelle_resids = micelle_whole(topology, trajectory).obtain_largest_micelle_resids(resids_total)
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>‘largest_micelle_resids’ is a np.array with the resids of the
molecules that belong to the same cluster of the steps of the
trajectory where SCP was ran.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>largest_micelle_resids
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">])]</span>
</pre></div>
</div>
<p>Now, let’s obtain the coordinates of the largest micelle made whole
across the periodic boundary conditions (PBC).</p>
<ol class="arabic simple" start="5">
<li><p>Let’s define the resname of the molecules that we want to reconstruct
with the make_whole function. More than one resname can be inputted.
Note that it should be the resname of the molecules of the
largest_micelle array.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>resname=[&#39;LIG&#39;]
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Also, the user needs to define the start, step and final step of
frames in which the user wants to run the analysis on. Note that they
need to be the same as the ones you ran the SCP clustering on.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>start=0
stop=10000
step=1
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Obtain the whole coordinates of the micelle. This is key to perform
the densitity calculation taking properly into account the PBC</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>atom_pos = micelle_whole(topology, trajectory).running_make_cluster_whole(resname, largest_micelle_resids, start, stop, step)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  0%|                                                                                                                                                   | 0/11 [00:00&lt;?, ?it/s]/home/raquellrdc/Desktop/PhD/pysoftk/alejandro_newest_releast_check/pysoftk_analysis_code/test_final/make_micelle_whole.py:347: FutureWarning: arrays to stack must be passed as a &quot;sequence&quot; type such as list or tuple. Support for non-sequence iterables such as generators is deprecated as of NumPy 1.16 and will raise an error in the future.
  atom_positions_over_trajectory = list(tqdm(map(self.make_cluster_whole, frames, resname, cluster_resids_f[0],
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:16&lt;00:00,  1.47s/it]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Elapsed</span> <span class="n">time</span> <span class="k">for</span> <span class="n">matrix</span> <span class="n">calculation</span><span class="p">:</span> <span class="mf">17.7199</span> <span class="n">seconds</span>
</pre></div>
</div>
<p>Now, atom_pos contains the coordinates of all the atoms of the micelle
made whole at each time step selected. In each array, the first element
is the time frame of the analysis, and the second the positions array</p>
<ol class="arabic simple" start="8">
<li><p>We are almost ready for the density calculation. But first, we need
to define the atoms for which you want to calculate the density. In
this case, we are going to calculate the density of the hydrophobic
block of the polymer, so we are going to select the main backbone
atoms of the hydrophobic block.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>MA_names = [&#39;C028&#39;, &#39;C024&#39;, &#39;C022&#39;, &#39;C02E&#39;, &#39;C02I&#39;, &#39;C02M&#39;, &#39;C02Q&#39;, &#39;C02U&#39;, &#39;C02Y&#39;, &#39;C00S&#39;, &#39;C00Q&#39;, &#39;C00M&#39;,
             &#39;C00L&#39;, &#39;C027&#39;,  &#39;C023&#39;, &#39;C021&#39;,  &#39;C02H&#39;,  &#39;C02L&#39;,  &#39;C02P&#39;,  &#39;C02T&#39;, &#39;C02X&#39;, &#39;C00U&#39;,  &#39;C00R&#39;,  &#39;C00P&#39;,
             &#39;O00A&#39;, &#39;O00D&#39;, &#39;O00C&#39;, &#39;O01G&#39;, &#39;O01F&#39;, &#39;O01D&#39;, &#39;O01A&#39;, &#39;O019&#39;, &#39;O016&#39;, &#39;O015&#39;, &#39;O010&#39;, &#39;O012&#39;,
             &#39;O00B&#39;, &#39;O00E&#39;, &#39;O01I&#39;, &#39;O01H&#39;, &#39;O01C&#39;, &#39;O01B&#39;, &#39;O01E&#39;, &#39;O018&#39;, &#39;O017&#39;, &#39;O014&#39;, &#39;O00Z&#39;, &#39;O013&#39;,
             &#39;C00O&#39;, &#39;C00W&#39;, &#39;C031&#39;, &#39;C030&#39;, &#39;C02W&#39;, &#39;C02S&#39;, &#39;C02O&#39;, &#39;C02K&#39;, &#39;C02G&#39;, &#39;C02D&#39;, &#39;C026&#39;, &#39;C02B&#39;]
</pre></div>
</div>
<ol class="arabic simple" start="9">
<li><p>Also, we need to define the heavy atoms of the solvent. This is
neccesary even if we are calculating the density of the polymer
components. This means that we need a trajectory with the solvent for
the intrinsic density calculation.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>water_atom=[&#39;OW&#39;] #for water the heavy atom is the Oxygen
</pre></div>
</div>
<ol class="arabic simple" start="10">
<li><p>That’s it! We have all the neccesary input files for the spherical
density calculation of the hydrophobic component. This function
outputs two arrays, the first one are the density values and the
second one are the binned space values. This function outputs these
two arrays for easier plotting.</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>density_whole_MA, binned_space = intrinsic_density(topology, trajectory).run_intrinsic_density(largest_micelle_resids, atom_pos, MA_names, MA_names, water_atom, start, stop, step)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  0%|                                                                                                                                                   | 0/11 [00:00&lt;?, ?it/s]/home/raquellrdc/Desktop/PhD/polymer/pysoftwhere/pySoftWhere/pySoftWhere/ICSI/icsi.py:85: RuntimeWarning: Mean of empty slice
  interface_vals[i][j]=np.nanmean([interface_vals[divmod(ip,len(interface_vals))[1]][divmod(jp,len(interface_vals))[1]] for ip,jp in product(n_i,n_j)])
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:34&lt;00:00,  3.12s/it]
/home/raquellrdc/Desktop/PhD/pysoftk/alejandro_newest_releast_check/pysoftk_analysis_code/test_final/intrinsic_density_micelle.py:280: RuntimeWarning: divide by zero encountered in divide
  final_density=intrinsic_density_profile/S_bar
/home/raquellrdc/Desktop/PhD/pysoftk/alejandro_newest_releast_check/pysoftk_analysis_code/test_final/intrinsic_density_micelle.py:280: RuntimeWarning: invalid value encountered in divide
  final_density=intrinsic_density_profile/S_bar
</pre></div>
</div>
<p>Note that MA_names is specified twice. This is because for the intrinsic
density you need to define the atoms that belong to the (hydrophobic)
core of the micelle. So the first specification is used to describe the
atoms in the core, and the second time to define the atoms you want to
calculate the density of. You do not need ot include all atoms in the
core, you can only input at least one atom of the backbone chain per
hydrophobic monomer</p>
<p>Also, note that we have left the values to be binned as the default one,
but you may want to change them depending on your system</p>
<p>Now, let’s plot the density to see how it looks.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt

plt.plot(binned_space, density_whole_MA)

plt.xlabel(&#39;r($\AA$)&#39;)
plt.ylabel(&#39;$\widetilde{\u03C1}(r)$($\AA^{-3}$)&#39;)
plt.ylim(0, 0.5) #the peak at the interface can be quite high, so this limit is to properly observe the distribution of the component within the micelle
plt.title(&#39;Intrinsic density of MA&#39;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Intrinsic density of MA&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/intrinsic_density_tutorial_30_1.png" src="../_images/intrinsic_density_tutorial_30_1.png" />
<p>Remember that the more data (frames and atoms) that you input, the
smoother your density will be</p>
</section>
<section id="intrinsic-density-water-tool">
<h2>intrinsic_density_water tool<a class="headerlink" href="#intrinsic-density-water-tool" title="Link to this heading"></a></h2>
<p>Now, let’s calculate the density of the water in the same simulation.
For this we need a different tool, intrinsic_density_water. We are going
to use the same trajectory, so no need to load it again. We just need to
start by importing the intrinsic_density_water_micelle class</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#from pysoftk.pol_analysis.intrinsic_density_water_micelle  import intrinsic_density_water
from intrinsic_density_water_micelle import intrinsic_density_water
</pre></div>
</div>
<p>We have already obtained the resids of the polymer belonging to the
largest micelle as well as the atom positions of the micelle made whole
across the PBC. So the only inputs needed for this function are the name
of the solvant atoms that we want to calculate the density of. In this
case the solvent is water, so we select the oxygen atoms.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>water_atoms=[&#39;OW&#39;]
</pre></div>
</div>
<p>We are ready to run the density of the water! - This will take longer,
since there are many water atoms in the system</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>density_whole_water, binned_space_water = intrinsic_density_water(topology, trajectory).run_intrinsic_density(largest_micelle_resids, atom_pos, water_atoms, MA_names, water_atoms, start, stop, step)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [02:58&lt;00:00, 16.22s/it]
/home/raquellrdc/Desktop/PhD/pysoftk/alejandro_newest_releast_check/pysoftk_analysis_code/test_final/intrinsic_density_water_micelle.py:332: RuntimeWarning: divide by zero encountered in divide
  final_density=intrinsic_density_profile/S_bar
/home/raquellrdc/Desktop/PhD/pysoftk/alejandro_newest_releast_check/pysoftk_analysis_code/test_final/intrinsic_density_water_micelle.py:332: RuntimeWarning: invalid value encountered in divide
  final_density=intrinsic_density_profile/S_bar
</pre></div>
</div>
<p>At this point, it is also needed to specify the core of the micelle,
since the intrinsic density is estimated with respect to the core-shell
interface. That is why we need to again input ‘MA_names’ that contains
some of the atoms of the hydrophobic block of the polymer.</p>
<p>Now let’s plot it to see how it looks</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.plot(binned_space_water, density_whole_water)

plt.xlabel(&#39;r($\AA$)&#39;)
plt.ylabel(&#39;$\widetilde{\u03C1}(r)$($\AA^{-3}$)&#39;)
plt.ylim(0, 0.1)
plt.xlim(-40, 75) # the densities of the far end reach very high values that are just artifacts of the calculations of the intrinsic density performed very far away from the micelle.
plt.title(&#39;Intrinsic density of Water&#39;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Intrinsic density of Water&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/intrinsic_density_tutorial_41_1.png" src="../_images/intrinsic_density_tutorial_41_1.png" />
<p>Looks like this micelle is not very stable since it has a lot of water
in the core!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ecc_tutorial.html" class="btn btn-neutral float-left" title="Tutorial on the usage of ecc_micelle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="micelle_whole_tutorial.html" class="btn btn-neutral float-right" title="Tutorial on the usage of micelle_whole tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Alejandro Santana-Bonilla, Raquel Lopez-Rios de Castro, and Chris Lorenz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>